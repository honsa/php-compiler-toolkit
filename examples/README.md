# Examples

Each folder here contains an example using the compiler toolkit `example.php`, and associated generated files.

# Compilation Times

Each example keeps track of how long it takes the backend to compile the code to native. The following table is a collation of the results:

<!-- compile time table start -->

| Example Name                  |   libgccjit |      libjit |        llvm |         php |
|-------------------------------|-------------|-------------|-------------|-------------|
|                00-basic-usage |    0.025765 |    0.000502 |    0.000583 |    0.000177 |
|                  01-branching |    0.042911 |    0.000605 |    0.000714 |    0.000221 |
|             02-function_calls |    0.025149 |    0.000527 |    0.000596 |    0.000244 |
|    03-iterated-function-calls |    0.030333 |    0.001262 |    0.001038 |    0.000414 |
|                    04-structs |    0.038853 |    0.000952 |    0.000832 |    0.000283 |
|         05-imported_functions |    0.030630 |             |    0.000716 |    0.000188 |

<!-- compile time table end -->

# Benchmark Results

Each example includes a benchmark comparing compiled code to a PHP closure (anonymous function). Here are the latest results:

<!-- benchmark table start -->

| Example Name                  |   libgccjit |      libjit |        llvm |         php | php closure |
|-------------------------------|-------------|-------------|-------------|-------------|-------------|
|                00-basic-usage |     0.14458 |     0.13496 |     0.16913 |     0.06893 |     0.04753 |
|                  01-branching |     0.13896 |     0.14805 |     0.14144 |     0.09502 |     0.04925 |
|             02-function_calls |     0.18040 |     0.16521 |     0.24001 |     0.21692 |     0.15103 |
|    03-iterated-function-calls |     0.14231 |     0.35324 |     0.38155 |     4.49203 |     2.61538 |
|                    04-structs |     0.16837 |     0.19674 |     0.17368 |     0.20833 |     0.17697 |
|         05-imported_functions |     0.14208 |             |     0.14868 |     0.09192 |     0.04973 |

<!-- benchmark table end -->

# Generated Result Files

## Intermediary Result: `example.ir`

This is representation of the function(s) being compiled, which is custom to this toolkit.

## Output: `example.output`

The raw text output of the execution of `example.php` (what you would get if you ran it yourself)

## libjit bytecode: `libjit.bc`

The libjit generated bytecode.

## libjit assembly: `libjit.s`

The disassembled machine code that libjit generated while compiling this function

## libgccjit bytecode: `libgccjit.c`

The libgccjit generated bytecode. Note that this is very similar to C, but not quite...

## libgccjit assembly: `libgccjit.s`

The optimized assembly that libgccjit generated while compiling this function

## LLVM bytecode: `llvm.bc`

The LLVM generated bytecode (IR).

## LLVM assembly: `llvm.s`

The optimized assembly that LLVM generated while compiling this function

## PHP Output: `php.php`

The compiled code is output as PHP! Woot!