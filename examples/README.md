# Examples

Each folder here contains an example using the compiler toolkit `example.php`, and associated generated files.

# Compilation Times

Each example keeps track of how long it takes the backend to compile the code to native. The following table is a collation of the results:

<!-- compile time table start -->

| Example Name                  |   libgccjit |      libjit |        llvm |         php |
|-------------------------------|-------------|-------------|-------------|-------------|
|                00-basic-usage |    0.026272 |    0.000521 |    0.000618 |    0.000190 |
|                  01-branching |    0.026251 |    0.000567 |    0.000758 |    0.000201 |
|             02-function_calls |    0.025797 |    0.000568 |    0.000678 |    0.000188 |
|    03-iterated-function-calls |    0.030672 |    0.001405 |    0.001055 |    0.000438 |
|                    04-structs |    0.025275 |    0.000561 |    0.000606 |    0.000201 |
|         05-imported_functions |    0.025177 |             |    0.000586 |    0.000177 |

<!-- compile time table end -->

# Benchmark Results

Each example includes a benchmark comparing compiled code to a PHP closure (anonymous function). Here are the latest results:

<!-- benchmark table start -->

| Example Name                  |   libgccjit |      libjit |        llvm |         php | php closure |
|-------------------------------|-------------|-------------|-------------|-------------|-------------|
|                00-basic-usage |     0.13683 |     0.13562 |     0.13395 |     0.06879 |     0.04610 |
|                  01-branching |     0.13580 |     0.13598 |     0.13389 |     0.09462 |     0.04644 |
|             02-function_calls |     0.13497 |     0.13679 |     0.13737 |     0.15896 |     0.11099 |
|    03-iterated-function-calls |     0.13312 |     0.32836 |     0.27324 |     3.75514 |     2.26959 |
|                    04-structs |     0.13679 |     0.14105 |     0.14205 |     0.15566 |     0.13603 |
|         05-imported_functions |     0.10114 |             |     0.10150 |     0.07039 |     0.04780 |

<!-- benchmark table end -->

# Generated Result Files

## Intermediary Result: `example.ir`

This is representation of the function(s) being compiled, which is custom to this toolkit.

## Output: `example.output`

The raw text output of the execution of `example.php` (what you would get if you ran it yourself)

## libjit bytecode: `libjit.bc`

The libjit generated bytecode.

## libjit assembly: `libjit.s`

The compiled and optimized assembly that libjit generated while compiling this function

## libgccjit bytecode: `libgccjit.c`

The libgccjit generated bytecode. Note that this is very similar to C, but not quite...

## libgccjit assembly: `libgccjit.s`

The compiled and optimized assembly that libgccjit generated while compiling this function

## LLVM bytecode: `llvm.bc`

The LLVM generated bytecode (IR).

## LLVM assembly: `llvm.s`

The compiled and optimized assembly that LLVM generated while compiling this function

## PHP Output: `php.php`

The compiled code is output as PHP! Woot!